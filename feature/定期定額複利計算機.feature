Feature: å®šæœŸå®šé¡è¤‡åˆ©è¨ˆç®—æ©Ÿ - å‰ç«¯é é¢èˆ‡ä½¿ç”¨è€…äº’å‹•
  ä½œç‚ºæŠ•è³‡æ–°æ‰‹
  æˆ‘æƒ³è¦ä¸€å€‹è¶…ç°¡å–®ã€è¶…ç¾çš„å‰ç«¯ä»‹é¢
  ç‚ºäº†å¿«é€Ÿè¼¸å…¥åƒæ•¸ä¸¦çœ‹åˆ°è¦–è¦ºåŒ–çµæœ
  è®“ç†è²¡è¦åŠƒè®Šå¾—æœ‰è¶£ä¸æ¯ç‡¥

  Background:
    Given æˆ‘é–‹å•Ÿç€è¦½å™¨é€²å…¥é¦–é  "/"
    Then é é¢æ‡‰è©²è¼‰å…¥åœ¨ 2 ç§’å…§
    And èƒŒæ™¯æ˜¯è¼•æŸ”æ¼¸å±¤ (#6366f1 to #8b5cf6)
    And ä¸­å¤®é¡¯ç¤ºä¸€å¼µåœ“è§’å¡ç‰‡ (max-width: 640px, bg-white, shadow-lg)

  @UI @InitialState
  Scenario: åˆå§‹é é¢è¼‰å…¥èˆ‡é è¨­å€¼
    Then å¡ç‰‡æ¨™é¡Œé¡¯ç¤º "å®šæœŸå®šé¡è¤‡åˆ©è¨ˆç®—æ©Ÿ" ä¼´éš¨ç«ç®­ emoji ğŸš€
    And é¡¯ç¤ºä¸‰å€‹è¼¸å…¥æ¬„ä½å‚ç›´æ’åˆ— (é–“è· 24px)
      | æ¬„ä½åç¨±       | é¡å‹          | é è¨­å€¼ | Label æ¨£å¼              |
      | æœˆæŠ•å…¥é‡‘é¡     | number input  | 10000  | ç²—é«”ç°å­— + å¿…å¡«æ˜Ÿè™Ÿ     |
      | é æœŸå¹´åŒ–å ±é…¬ç‡ | select        | 6      | ä¸‹æ‹‰é¸å–® 1-15% æ•´æ•¸     |
      | æŠ•è³‡å¹´æ•¸       | number input  | 20     | ç²—é«”ç°å­— + ç¯„åœæç¤º     |
    And æœ€ä¸‹æ–¹æœ‰ç´«è‰²æŒ‰éˆ• "é¦¬ä¸Šè¨ˆç®—" (bg-purple-600, hover:bg-purple-700, disabled:gray)
    And æŒ‰éˆ•åˆå§‹ç‚º enabled

  @RWD @Mobile
  Scenario: æ‰‹æ©Ÿç‰ˆè‡ªé©æ‡‰é¡¯ç¤º
    Given æˆ‘ç”¨æ‰‹æ©Ÿå°ºå¯¸ (375x667) ç€è¦½
    Then å¡ç‰‡å¯¬åº¦è®Šæˆ 100% (padding: 16px)
    And è¼¸å…¥æ¡†é«˜åº¦è‡³å°‘ 56px (è§¸æ§å‹å–„)
    And æŒ‰éˆ• sticky åœ¨åº•éƒ¨ (fixed bottom-0, full width)
    And ç„¡æ©«å‘æ²è»¸ï¼Œä¸€åˆ‡å‚ç›´æµæš¢

  @Validation @ErrorHandling
  Scenario Outline: å³æ™‚é©—è­‰ç„¡æ•ˆè¼¸å…¥
    When æˆ‘å°‡ "<æ¬„ä½>" è¼¸å…¥ "<ç„¡æ•ˆå€¼>"
    And æˆ‘é»æ“Šé é¢ç©ºç™½è™•æˆ– tab out
    Then "<æ¬„ä½>" ä¸‹æ–¹é¡¯ç¤ºç´…è‰²éŒ¯èª¤è¨Šæ¯ "<éŒ¯èª¤è¨Šæ¯>" (role=alert, fade-in å‹•ç•«)
    And è¼¸å…¥æ¡†é‚Šæ¡†è®Šç´… (border-red-500)
    And æŒ‰éˆ•è®Šæˆ disabled (opacity-50)
    And é é¢ä¸é€å‡ºè«‹æ±‚

    Examples:
      | æ¬„ä½         | ç„¡æ•ˆå€¼ | éŒ¯èª¤è¨Šæ¯                   |
      | æœˆæŠ•å…¥é‡‘é¡   | 0      | æœˆæŠ•å…¥é‡‘é¡å¿…é ˆå¤§æ–¼ 0 å…ƒ     |
      | æœˆæŠ•å…¥é‡‘é¡   | -500   | æœˆæŠ•å…¥é‡‘é¡å¿…é ˆå¤§æ–¼ 0 å…ƒ     |
      | æŠ•è³‡å¹´æ•¸     | 0      | æŠ•è³‡å¹´æ•¸è‡³å°‘ 1 å¹´          |
      | æŠ•è³‡å¹´æ•¸     | 51     | æŠ•è³‡å¹´æ•¸æœ€å¤š 50 å¹´         |
      | å¹´åŒ–å ±é…¬ç‡   | N/A    | (ä¸‹æ‹‰ç„¡ç„¡æ•ˆï¼Œä½†è‹¥ JS æ”¹å€¼) |

  @Interaction @SuccessPath
  Scenario: æˆåŠŸè¨ˆç®—å¾Œçµæœé¡¯ç¤ºèˆ‡å‹•ç•«
    Given æˆ‘è¼¸å…¥æœ‰æ•ˆå€¼: æœˆæŠ• 10000, å¹´åŒ– 6%, å¹´æ•¸ 20
    When æˆ‘é»æ“Š "é¦¬ä¸Šè¨ˆç®—"
    Then æŒ‰éˆ•é¡¯ç¤º loading spinner (0.5s)
    And å¡ç‰‡ä¸‹æ–¹æ·¡å…¥çµæœå€å¡Š (transition-opacity duration-300)
    And çµæœé¡¯ç¤ºåœ¨ç¶ è‰²å¡ç‰‡å…§:
      | é …ç›®         | æ¨£å¼                           | ç¯„ä¾‹å€¼       |
      | æœ€çµ‚è³‡ç”¢     | è¶…å¤§å­— (text-4xl text-purple-700) + è¨ˆæ•¸å‹•ç•« | 4,604,874 å…ƒ |
      | ç¸½æŠ•å…¥æœ¬é‡‘   | ä¸­å­—ç°è‰² (text-xl text-gray-600) | 2,400,000 å…ƒ |
      | æŠ•è³‡å ±é…¬     | ä¸­å­—ç¶ è‰² (text-xl text-green-600) + ä¸Šç®­é ­ icon | 2,204,874 å…ƒ |
    And ä¸‹æ–¹é¡¯ç¤ºæŠ˜ç·šåœ–å®¹å™¨ (id="dca-chart", height: 300px)
    And åœ–è¡¨è‡ªå‹•æ¸²æŸ“è—è‰²æ›²ç·š (data from yearly amounts, tooltip: "ç¬¬ X å¹´: Y å…ƒ")

  @Chart @Visualization
  Scenario: åœ–è¡¨ç¤ºäº’å‹•ç´°ç¯€
    Given è¨ˆç®—å®Œæˆ
    Then åœ–è¡¨ä½¿ç”¨ Chart.js (line chart, tension: 0.4 for smooth curve)
    And X è»¸: å¹´ä»½ 1 to 20 (labels: ['1', '2', ..., '20'])
    And Y è»¸: è³‡ç”¢é‡‘é¡ (å¾ 0 é–‹å§‹, è‡ªå‹•æ ¼å¼ '1M' for ç™¾è¬)
    And æ›²ç·šé¡è‰²: #7c3aed (purple vibe)
    And hover: é¡¯ç¤º tooltip with ç²¾ç¢ºé‡‘é¡
    And æ‰‹æ©Ÿ: touch æ»‘å‹•åœ–è¡¨ (pan enabled)

  @Accessibility @A11y
  Scenario: ç„¡éšœç¤™æ”¯æ´
    Then æ‰€æœ‰ input æœ‰ aria-label (e.g., aria-label="è¼¸å…¥æ¯æœˆæŠ•å…¥é‡‘é¡")
    And æŒ‰éˆ•æœ‰ aria-label="è¨ˆç®—å®šæœŸå®šé¡è¤‡åˆ©çµæœ"
    And éŒ¯èª¤è¨Šæ¯æœ‰ role="alert" å’Œ aria-live="assertive"
    And çµæœæ•¸å­—æœ‰ aria-describedby="result-description"
    And åœ–è¡¨æœ‰ alt text æˆ– aria-hidden (with text summary below)
    And æ”¯æ´éµç›¤: Tab åˆ° input, Enter é€å‡ºè¡¨å–®

  @Performance @EdgeCase
  Scenario: æ¥µç«¯è¼¸å…¥ä¸‹çš„é é¢æ•ˆèƒ½
    Given æˆ‘è¼¸å…¥æœˆæŠ• 1000000, å¹´åŒ– 15%, å¹´æ•¸ 50
    When é»æ“Šè¨ˆç®—
    Then åœ–è¡¨æ¸²æŸ“ < 200ms (no lag)
    And é é¢ç„¡ crash, æ•¸å­—ç”¨ç§‘å­¸è¨˜è™Ÿè‹¥å¤ªå¤§ (ä½†é€™ç‰ˆç”¨ long, max ~10^18)